#!/bin/bash

index_file=/tmp/.rofi_index_file

update_index() {
        find Documents Downloads Music Pictures Podcasts Videos -not -type d 2> /dev/null | sed -e 's/^/ /g' -E -e '/png$|jpg$|tiff$|gif$|jpeg$|bmp$/ s/^./ /g' -e '/mp3$|pcm$|wav$|aac$|ogg$|wma$/ s/^./ /g' -e '/wmv$|webm$|m4v$|mkv$|mov$|flv$|avi$|mp4$/ s/^./辶 /g' > "$index_file"
}

if [ -e $index_file ]; then
  input=$(cat $index_file | rofi -dmenu -p "Find file:")
  update_index &
else
  update_index
  input=$(cat $index_file | rofi -dmenu -p "Find file:")
fi

jaro "$(echo $input | sed 's/^..//g')" &> /dev/null &

