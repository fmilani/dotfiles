#!/bin/sh

LAPTOP="eDP-1"
ULTRA="DP-2"

LEFT="DP-2-left"
CENTER="DP-2-center"
RIGHT="DP-2-right"

cleanup_monitors() {
  xrandr --delmonitor "$LEFT" >/dev/null 2>&1
  xrandr --delmonitor "$CENTER" >/dev/null 2>&1
  xrandr --delmonitor "$RIGHT"  >/dev/null 2>&1
}

if xrandr | grep -Eq "^$ULTRA connected .*2560x1080|^$ULTRA disconnected" ; then
  echo "→ Switching to laptop screen ($LAPTOP)"

  cleanup_monitors

  xrandr \
    --output "$ULTRA" --off \
    --output "$LAPTOP" --mode 1280x720 --primary

else
  echo "→ Switching to ultrawide split (3 monitors on $ULTRA)"

  cleanup_monitors

  xrandr \
    --output "$LAPTOP" --off \
    --output "$ULTRA" --mode 2560x1080 --pos 0x0 --primary

  xrandr \
    --setmonitor "$LEFT"   640/300x1080/340+0+0     "$ULTRA" \
    --setmonitor "$CENTER" 1280/600x1080/340+640+0  none \
    --setmonitor "$RIGHT"  640/300x1080/340+1920+0  none
fi

