#!/bin/sh

main(){
	local choice=$(echo -e "add\ndel" | dmenu -p "bookmarks")
	case "$choice" in
		"add")
			local url=""
			local cb=$(xclip -sel clip -o)
			if [[ $cb == https* ]]; then
				url=$(echo "$cb" | sed 's|^https://||; s|^www\.||')
				local use_url=$(echo -e "yes\nno" | dmenu -p "bookmark $url?")
				[[ -z $use_url || $use_url == "no" ]] && url=""
			fi
			bookmarks add "$url"
			cd ~/dotfiles && git add surfraw/.config/surfraw/bookmarks && git commit -m "add $url to bookmarks" && git push
			;;
		"del")
			bookmarks del
			;;
		*)
			exit 0
			;;
	esac
}

main
